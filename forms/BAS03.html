<!DOCTYPE html>

<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="google" content="notranslate">
    <!-- Diable cache for Chrome -->
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-store" />
    <meta http-equiv="expires" content="-1" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="shortcut icon" href="../image/favicon.png">
    <link rel="icon" href="../image/favicon.png" type="image/x-icon" />

    <link href="../css/form/pass_blue.css" rel="stylesheet" />
    <link href="../css/form/pass_custom.css" rel="stylesheet" />
    <link href="../css/myProj1.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--JQuery-->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

    <!--JQuery UI-->
    <link href="../js/jquery-ui/1.12.1.custom/jquery-ui.min.css" rel="stylesheet" type="text/css" />
    <script src="../js/jquery-ui/1.12.1.custom/jquery-ui.min.js" type="text/javascript"></script>

    <title>Class Sign-in Form _ Link</title>
    <script>
        var classid = 'BAS03';
        var classdate = '2022-08-03';
        var trainer = "sonia";        
    </script>
</head>

<body>
    <div style="width:80%;margin:0px auto;">
        <form action="#">
            <fieldset>
                <legend class="col text-center formTitle">Class Sign-in Form <div id="yourname"></div>
                </legend>
                <div id="div_criteria">
                    <legend class="tb1">Query Criteria</legend>
                    <table id="tab_criteria" style="width: 100%">
                        <tr>
                            <td style="width: 15%" class="title" rowspan="2">Class：</td>
                            <td style="width: 85%" class="info">
                                <select id="classid" name="classid">
                                    ? ? ? ? ? ? ? ? ? <option value="BAS01">BAS01_HTML vs. IIS web site</option>
                                    ? ? ? ? ? ? ? ? ? <option value="BAS02">BAS02_CSS/JavaScript/HTML DOM</option>
                                    <option value="BAS03">BAS03_JQuery/Vue.js</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td class="info">
                                <table style="width: 100%">
                                    <tr>
                                        <td style="width: 15%" class="title">Class Date：</td>
                                        <td style="width: 35%"><input type="date" name="classdate" id="classdate"></td>
                                        <td style="width: 15%" class="title">Trainer：</td>
                                        <td style="width: 35%"><input type="text" name="trainer" id="trainer"></td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="center" colspan="2">
                                <!-- <button id="query" type="button" class="btn btn-primary btn-sm" onclick="doQuery()">Query</button> -->
                                <button id="query" type="button" class="btn btn-primary btn-sm">Query</button>
                                <!-- <button id="abort" type="reset" class="btn btn-secondary btn-sm" onclick="doAbort(event,this)">Abort</button> -->
                                <button id="abort" type="reset" class="btn btn-secondary btn-sm">Abort</button>
                            </td>
                        </tr>
                    </table>
                    <br><br>
                </div>
                <div id="div_result" style="display:none;">
                    <legend class="tb1">Query Result</legend>
                    <!-- <i id="entry" class="fa fa-plus" style="font-size:20px;color:green;cursor: pointer;" onclick="doEntry()"></i> -->
                    <i id="entry" class="fa fa-plus" style="font-size:20px;color:green;cursor: pointer;"></i>
                    <table cellspacing="0" cellpadding="6" rules="all" border="1" width="100%">
                        <thead>
                            <tr>
                                <th class="title">Del</th>
                                <th class="title">ClassName</th>
                                <th class="title">ClassDate</th>
                                <th class="title">Trainee</th>
                                <th class="title">Sign-in</th>
                                <th class="title">Homework(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="data_01">
                                <!-- <td class="info"><i class="fa fa-minus" style="font-size:20px;color:red;cursor: pointer;" onclick="del('data_01')"></i></td>                     -->
                                <td class="info"><i class="fa fa-minus"
                                        style="font-size:20px;color:red;cursor: pointer;"></i></td>
                                <td class="info">BAS01_HTML vs. IIS web site</td>
                                <td class="info">2022/08/28</td>
                                <td class="info">link</td>
                                <td class="info"><input type="checkbox" checked id="chk_signin_1" name="chk_signin" />
                                </td>
                                <td class="info">100%</td>
                            </tr>
                            <tr id="data_02">
                                <td class="info"><i class="fa fa-minus"
                                        style="font-size:20px;color:red;cursor: pointer;" onclick="del('data_02')"></i>
                                </td>
                                <td class="info">BAS02_VS2013 Web Application</td>
                                <td class="info">2022/09/06</td>
                                <td class="info">link</td>
                                <td class="info"><input type="checkbox" id="chk_signin_1" name="chk_signin" /></td>
                                <td class="info">&nbsp;</td>
                            </tr>
                        </tbody>
                    </table>
                    <br><br>
                </div>
                <div id="div_entry" style="display:none;">
                    <legend class="tb1">Entry/Change</legend>
                    <table style="width: 100%">
                        <tr>
                            <td style="width: 15%" class="title" rowspan="2">Class：</td>
                            <td style="width: 85%" class="info">
                                <select id="classid" name="classid" onfocus="defaultIndex=this.selectedIndex"
                                    onchange="this.selectedIndex=defaultIndex">
                                    ? ? ? ? ? ? ? ? ? <option value="BAS01">BAS01_HTML vs. IIS web site</option>
                                    ? ? ? ? ? ? ? ? ? <option value="BAS02">BAS02_CSS/JavaScript/HTML DOM</option>
                                    <option value="BAS03">BAS03_JQuery/Vue.js</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td class="info">
                                <table style="width: 100%">
                                    <tr>
                                        <td style="width: 15%" class="title">Class Date：</td>
                                        <td style="width: 35%"><input type="date" name="classdate" id="classdate"
                                                value="2022-08-31" readonly></td>
                                        <td style="width: 15%" class="title">Trainer：</td>
                                        <td style="width: 35%"><input type="text" name="trainer" id="trainer"
                                                value="sonia" readonly></td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 15%" class="title" rowspan="2">Trainee：</td>
                            <td style="width: 85%" class="info">
                                <select id="trainee" name="Trainee">
                                    ? ? ? ? ? ? ? ? ? <option selected="selected" value="link">link</option>
                                    ? ? ? ? ? ? ? ? ? <option value="stanleyl">stanleyl</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td class="info">
                                <table style="width: 100%">
                                    <tr>
                                        <td style="width: 15%" class="title">Sign-in：</td>
                                        <td style="width: 35%"><input type="checkbox" name="signin" id="signin" checked>
                                        </td>
                                        <td style="width: 15%" class="title">Homework(%):</td>
                                        <td style="width: 35%"><input type="number" name="Homework" id="Homework"
                                                value="20" min="0" max="100"></td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="center" colspan="2">
                                <!-- <button id="save" type="button" class="btn btn-primary btn-sm" onclick="doSave()">Save</button> -->
                                <button id="save" type="button" class="btn btn-primary btn-sm">Save</button>
                                <!-- <button id="abort1" type="button" class="btn btn-secondary btn-sm" onclick="doAbort()">Abort</button> -->
                                <button id="abort1" type="button" class="btn btn-secondary btn-sm">Abort</button>
                            </td>
                        </tr>
                    </table>
                </div>
            </fieldset>
        </form>
    </div>
    <div id="dialog-message" title="請檢查~~" class="hide"></div>

    <!-- <script src="../js/moment.min.js"></script> -->
    <script>
        // `date` is a `Date` object
        const formatYmd = date => date.toISOString().slice(0, 10);
        // Example
        const today = formatYmd(new Date());      // 2020-05-06        

        let initialize = function () { // loaddata
            try {
                // document.getElementById("classid").value = classid;
                // document.getElementById("classdate").value = classdate;
                // document.getElementById("trainer").value = trainer;
                $('#classid').val(classid);
                $('#classdate').val(classdate);
                $('#trainer').val(trainer);

                $.ajax({
                    type: 'GET',
                    //url: 'http://e00d02x04089/myProj20220913/Form/hello.html',  //myProj2
                    url: 'http://e00d02x04089/BAS03/Form/BAS03.aspx',
                    data: 'ID=link', //發送參數=>bug
                    success: function (data) {
                        console.log(data); //輸出結果
                        // $('#yourname').html(data); //將結果呈現在Div裡                        
                        $("#yourname").html(data); //將結果呈現在Div裡                        
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        $("body").append(xhr.status);
                        $("body").append(xhr.responseText);
                        alert("Ajax發生錯誤!!");
                    }
                });


                //  $.ajax({
                //         type: 'POST',
                //         url: 'http://e00d02x04940/BAS03/WebService1.asmx/GetTrainees',      
                //         contentType: "application/json; charset=utf-8", // 參數格式
                //         dataType: "json", // 回傳格式
                //         success: function (data) {                                                
                //             let _ret = JSON.parse(data.d);
                //             let _retStr = "";
                //             $.each(_ret, function(index, element) {
                //                 _retStr += index + " - " + element.empid+":"+element.name + "\n";
                //             });
                //             alert(_retStr);
                //             //$("#show").html(ret.replace(/\n/g, "<br />"));  
                //             //$("body").append(xhr.status);                                                                      
                //         },
                //         error: function (xhr, ajaxOptions, thrownError) {
                //             $("body").append(xhr.status);
                //             $("body").append(xhr.responseText);
                //             alert("Ajax發生錯誤!!");
                //         }
                //  });                  
            } catch (ex) {
                console.log(ex.message);
            }
        }

        let del = function (dataid) {
            try {
                //document.getElementById(dataid).style.display = "none";
                $("[id='" + dataid + "']").hide();
            } catch (ex) {
                console.log(ex.message);
            }
        }

        // JQuery --Shorthand for $( document ).ready(): DOM is ready for JavaScript code to execute
        $(function () {
            try {
                //-- initial data--
                initialize();

                //-- event handler--
                $("#trainee").change(function () {
                    $(this).css("background-color", "#D6D6FF");
                    $("#signin").attr('checked', false);
                    $("#homework").val('0');
                });
                $("#query").click(function () {
                    doQuery();
                });
                $("#entry").click(function () {
                    doEntry();
                });
                $("button.btn-secondary").click(function () {
                    console.log("click from", $(this).attr("id"));
                    $('#div_criteria').show();
                    $('#div_result').hide();
                    $('#div_entry').hide();
                });
                $("i.fa-minus").click(function () {
                    console.log("click from", $(this).attr("id"));
                    $(this).parent().parent().hide();
                })
            } catch (e) {
                alert(e);
            }
        });


        function doQuery() {
            try {
                let _classid = $("#classid :selected").val();
                let _classdate = $("#classdate").val();
                //document.getElementById("div_result").style.display="block";                

                //[HW2.]If Criteria-selected class’s classdate is in future, Query result is readonly, please hide:+-
                if (_classdate > today && typeof _classdate != "null") {
                    $(".fa-plus").hide();
                    $(".fa-minus").hide();
                }
                // $("#div_result").show();
                $("#div_result").show(function () {

                    if ($("tbody").val() == "link") {
                        console.log($(this));//link
                        $(this).css("border-bottom:thick dotted #ff0000");
                        // $(this).css(BottomborderBottomColor = "#ff0000");
                    };
                });
            } catch (ex) {
                console.log(ex.message);
            }
        }
        function doEntry() {
            try {
                $('#div_entry').show();
                $('#div_criteria').hide();
                $('#div_result').hide();
            } catch (ex) {
                console.log(ex.message);
            }
        }
        function doSave() {
            try {
                let _classdate = $("#classdate").val();
                if (_classdate > today) {
                    AlertMsg("class in future, can not be entry!");
                    return false;
                }
                let _signin = $("#signin")[0].checked;
                let _homework = $("#homework").val();
                if (_signin && (_homework === "" || _homework === "0")) {
                    AlertMsg("If sign-in,please entry 「homework %」!");
                    return false;
                }
                $('#div_criteria').show();
                $('#div_result').hide();
                $('#div_entry').hide();
            } catch (ex) {
                console.log(ex.message);
            }
        }
        function doAbort(e, el) {
            try {
                $('#div_criteria').show();
                $('#div_result').hide();
                $('#div_entry').hide();

                e = e || window.event;
                console.log("event type:", e.type); //will be the event
                console.log("event element id:", el.id); //we be the dom element
            } catch (ex) {
                console.log(ex.message);
            }
        }

        function AlertMsg(msg) {
            $("#dialog-message").html(msg);
            $("#dialog-message").dialog({
                height: "auto",
                modal: true,
                buttons: {
                    Ok: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }        
    </script>
</body>

</html>